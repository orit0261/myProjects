SELECT "chargeDescription", mode, count(*) as c
FROM dblink('dbname=postgres host = jsc-dev.cwxpg6kgeh7f.eu-central-1.rds.amazonaws.com user=Postgresadmin password=Yuvalez978',
    'select "chargeDescription", mode
     from prod.shipments_unique_charges ch inner join prod.shipments sh on sh.s_id = ch.s_id 
     order by "chargeDescription"')
  AS t1("chargeDescription" text, mode text)
group by "chargeDescription",mode
    
UNION ALL
SELECT "chargeDescription", mode, count(*) as c
FROM dblink('dbname=postgres host = pilot-dev.cwxpg6kgeh7f.eu-central-1.rds.amazonaws.com user=Postgresadmin password=Yuvalez978', 
    'select "chargeDescription", mode
     from prod.shipments_unique_charges ch inner join prod.shipments sh on sh.s_id = ch.s_id 
     order by "chargeDescription"')
  AS t2("chargeDescription" text, mode text)
group by "chargeDescription",mode

UNION ALL
SELECT "chargeDescription", mode, count(*) as c
FROM dblink('dbname=postgres host = ups-il-dev.cwxpg6kgeh7f.eu-central-1.rds.amazonaws.com user=Postgresadmin password=Yuvalez978',
    'select "chargeDescription", mode
     from prod.shipments_unique_charges ch inner join prod.shipments sh on sh.s_id = ch.s_id 
     order by "chargeDescription"')
  AS t3("chargeDescription" text, mode text)
group by "chargeDescription",mode

